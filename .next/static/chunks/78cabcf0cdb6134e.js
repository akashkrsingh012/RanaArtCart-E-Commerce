(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89530,e=>{"use strict";let s=(0,e.i(25094).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],89530)},46284,e=>{"use strict";let s=(0,e.i(25094).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>s],46284)},1125,e=>{"use strict";var s=e.i(36948),a=e.i(29474),r=e.i(69363),t=e.i(19889),l=e.i(91796),d=e.i(89530),i=e.i(46284);function c(){let{items:e,clearCart:c}=(0,a.useCart)(),{user:n,addOrder:m}=(0,r.useUser)(),o=(0,l.useRouter)(),u=(0,l.useSearchParams)(),x=u.get("productId"),p=u.get("sellerId"),[h,b]=(0,t.useState)(!1),[g,j]=(0,t.useState)(!1),[y,f]=(0,t.useState)(null),[N,v]=(0,t.useState)(null),[k,w]=(0,t.useState)(!!x),[C,S]=(0,t.useState)({name:n?.name||"",email:n?.email||"",address:"",city:"",state:"",zip:"",country:"India"});(0,t.useEffect)(()=>{n&&S(e=>({...e,name:n.name||e.name,email:n.email||e.email}))},[n]),(0,t.useEffect)(()=>{(async()=>{if(x)try{let e=await fetch(`/api/products/${x}`);if(e.ok){let s=await e.json();v({id:s.product._id,name:s.product.name,price:s.product.price,image:s.product.image,quantity:1})}}catch(e){console.error("Error fetching buy now product:",e)}finally{w(!1)}})()},[x]);let z=N?[N]:e,q=z.reduce((e,s)=>e+s.price*s.quantity,0),F=q>999?0:99,I=q+F,P=async e=>{e.preventDefault(),b(!0),f(null);try{let e={items:z.map(e=>({productId:e.id,name:e.name,price:e.price,quantity:e.quantity,image:e.image})),totalAmount:I,shippingAddress:{name:C.name,email:C.email,address:C.address,city:C.city,state:C.state,zip:C.zip,country:C.country},sellerId:N?p:void 0},s=await m(e);o.push(`/payment?orderId=${s._id}`)}catch(s){console.error("Order failed:",s);let e=s instanceof Error?s.message:"Failed to place order. Please try again.";f(e),(e.includes("log in")||e.includes("Session expired"))&&setTimeout(()=>{o.push("/login")},2e3)}finally{b(!1)}};return k?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsx)(d.Loader2,{size:32,className:"animate-spin text-primary"})}):g?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)(i.CheckCircle2,{size:64,className:"text-green-500 mx-auto"}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Order Placed Successfully!"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Redirecting to your orders..."})]})}):0===z.length?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Your checkout is empty"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Add some items to checkout"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-background py-8 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Checkout"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6 shadow-sm",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,s.jsx)("div",{className:"space-y-4 max-h-[300px] overflow-auto pr-2",children:z.map(e=>(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-md overflow-hidden bg-muted flex-shrink-0",children:(0,s.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-medium line-clamp-1",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Qty: ",e.quantity]}),(0,s.jsxs)("p",{className:"text-sm font-semibold",children:["₹",(e.price*e.quantity).toLocaleString("en-IN")]})]})]},e.id))}),(0,s.jsxs)("div",{className:"border-t border-border mt-4 pt-4 space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsxs)("span",{children:["₹",q.toLocaleString("en-IN")]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Shipping"}),(0,s.jsx)("span",{children:0===F?"Free":`₹${F}`})]}),(0,s.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t border-border",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsxs)("span",{className:"text-primary",children:["₹",I.toLocaleString("en-IN")]})]})]})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6 shadow-sm",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Delivery Details"}),y&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:y}),(0,s.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"name",className:"text-sm font-medium",children:"Full Name"}),(0,s.jsx)("input",{id:"name",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:C.name,onChange:e=>S({...C,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,s.jsx)("input",{id:"email",type:"email",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:C.email,onChange:e=>S({...C,email:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"address",className:"text-sm font-medium",children:"Address"}),(0,s.jsx)("textarea",{id:"address",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background min-h-[80px]",value:C.address,onChange:e=>S({...C,address:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"city",className:"text-sm font-medium",children:"City"}),(0,s.jsx)("input",{id:"city",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:C.city,onChange:e=>S({...C,city:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"state",className:"text-sm font-medium",children:"State"}),(0,s.jsx)("input",{id:"state",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:C.state,onChange:e=>S({...C,state:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"zip",className:"text-sm font-medium",children:"PIN Code"}),(0,s.jsx)("input",{id:"zip",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:C.zip,onChange:e=>S({...C,zip:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{htmlFor:"country",className:"text-sm font-medium",children:"Country"}),(0,s.jsx)("input",{id:"country",readOnly:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-muted text-muted-foreground cursor-not-allowed",value:C.country})]})]}),(0,s.jsx)("button",{type:"submit",disabled:h,className:"w-full py-3 mt-4 bg-primary text-primary-foreground font-bold rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Loader2,{size:20,className:"animate-spin"}),"Processing..."]}):"Proceed to Pay"})]})]})})]})]})})}function n(){return(0,s.jsx)(t.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsx)(d.Loader2,{size:32,className:"animate-spin text-primary"})}),children:(0,s.jsx)(c,{})})}e.s(["default",()=>n])}]);