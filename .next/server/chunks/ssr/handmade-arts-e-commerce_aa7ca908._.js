module.exports=[99102,a=>{"use strict";let b=(0,a.i(15867).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],99102)},19480,a=>{"use strict";let b=(0,a.i(15867).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],19480)},74079,a=>{"use strict";var b=a.i(56221),c=a.i(80976),d=a.i(51193),e=a.i(34732),f=a.i(25332),g=a.i(99102),h=a.i(19480);function i(){let{items:a,clearCart:i}=(0,c.useCart)(),{user:j,addOrder:k}=(0,d.useUser)(),l=(0,f.useRouter)(),m=(0,f.useSearchParams)(),n=m.get("productId"),o=m.get("sellerId"),[p,q]=(0,e.useState)(!1),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),[v,w]=(0,e.useState)(null),[x,y]=(0,e.useState)(!!n),[z,A]=(0,e.useState)({name:j?.name||"",email:j?.email||"",address:"",city:"",state:"",zip:"",country:"India"});(0,e.useEffect)(()=>{j&&A(a=>({...a,name:j.name||a.name,email:j.email||a.email}))},[j]),(0,e.useEffect)(()=>{(async()=>{if(n)try{let a=await fetch(`/api/products/${n}`);if(a.ok){let b=await a.json();w({id:b.product._id,name:b.product.name,price:b.product.price,image:b.product.image,quantity:1})}}catch(a){console.error("Error fetching buy now product:",a)}finally{y(!1)}})()},[n]);let B=v?[v]:a,C=B.reduce((a,b)=>a+b.price*b.quantity,0),D=C>999?0:99,E=C+D,F=async a=>{a.preventDefault(),q(!0),u(null);try{let a={items:B.map(a=>({productId:a.id,name:a.name,price:a.price,quantity:a.quantity,image:a.image})),totalAmount:E,shippingAddress:{name:z.name,email:z.email,address:z.address,city:z.city,state:z.state,zip:z.zip,country:z.country},sellerId:v?o:void 0},b=await k(a);l.push(`/payment?orderId=${b._id}`)}catch(b){console.error("Order failed:",b);let a=b instanceof Error?b.message:"Failed to place order. Please try again.";u(a),(a.includes("log in")||a.includes("Session expired"))&&setTimeout(()=>{l.push("/login")},2e3)}finally{q(!1)}};return x?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,b.jsx)(g.Loader2,{size:32,className:"animate-spin text-primary"})}):r?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)(h.CheckCircle2,{size:64,className:"text-green-500 mx-auto"}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Order Placed Successfully!"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Redirecting to your orders..."})]})}):0===B.length?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Your checkout is empty"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Add some items to checkout"})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-background py-8 px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Checkout"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6 shadow-sm",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),(0,b.jsx)("div",{className:"space-y-4 max-h-[300px] overflow-auto pr-2",children:B.map(a=>(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-md overflow-hidden bg-muted flex-shrink-0",children:(0,b.jsx)("img",{src:a.image,alt:a.name,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-medium line-clamp-1",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Qty: ",a.quantity]}),(0,b.jsxs)("p",{className:"text-sm font-semibold",children:["₹",(a.price*a.quantity).toLocaleString("en-IN")]})]})]},a.id))}),(0,b.jsxs)("div",{className:"border-t border-border mt-4 pt-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Subtotal"}),(0,b.jsxs)("span",{children:["₹",C.toLocaleString("en-IN")]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Shipping"}),(0,b.jsx)("span",{children:0===D?"Free":`₹${D}`})]}),(0,b.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t border-border",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsxs)("span",{className:"text-primary",children:["₹",E.toLocaleString("en-IN")]})]})]})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6 shadow-sm",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-6",children:"Delivery Details"}),t&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:t}),(0,b.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"name",className:"text-sm font-medium",children:"Full Name"}),(0,b.jsx)("input",{id:"name",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:z.name,onChange:a=>A({...z,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email"}),(0,b.jsx)("input",{id:"email",type:"email",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:z.email,onChange:a=>A({...z,email:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"address",className:"text-sm font-medium",children:"Address"}),(0,b.jsx)("textarea",{id:"address",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background min-h-[80px]",value:z.address,onChange:a=>A({...z,address:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"city",className:"text-sm font-medium",children:"City"}),(0,b.jsx)("input",{id:"city",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:z.city,onChange:a=>A({...z,city:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"state",className:"text-sm font-medium",children:"State"}),(0,b.jsx)("input",{id:"state",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:z.state,onChange:a=>A({...z,state:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"zip",className:"text-sm font-medium",children:"PIN Code"}),(0,b.jsx)("input",{id:"zip",required:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-background",value:z.zip,onChange:a=>A({...z,zip:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{htmlFor:"country",className:"text-sm font-medium",children:"Country"}),(0,b.jsx)("input",{id:"country",readOnly:!0,className:"w-full px-3 py-2 border border-input rounded-md bg-muted text-muted-foreground cursor-not-allowed",value:z.country})]})]}),(0,b.jsx)("button",{type:"submit",disabled:p,className:"w-full py-3 mt-4 bg-primary text-primary-foreground font-bold rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2",children:p?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Loader2,{size:20,className:"animate-spin"}),"Processing..."]}):"Proceed to Pay"})]})]})})]})]})})}function j(){return(0,b.jsx)(e.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,b.jsx)(g.Loader2,{size:32,className:"animate-spin text-primary"})}),children:(0,b.jsx)(i,{})})}a.s(["default",()=>j])}];

//# sourceMappingURL=handmade-arts-e-commerce_aa7ca908._.js.map